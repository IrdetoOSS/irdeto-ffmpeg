SET(IR_XPS_SRC  ir_xps_common.c)

ADD_LIBRARY(irxps SHARED ${IR_XPS_SRC} )

TARGET_INCLUDE_DIRECTORIES(irxps PRIVATE . PUBLIC $<BUILD_INTERFACE:${IR_PROJECT_DIR}/include> PUBLIC $<INSTALL_INTERFACE:${IR_INCDIR}>)
TARGET_COMPILE_OPTIONS(irxps PRIVATE -mfpmath=sse -msse4.1 -Wall -Werror -Wextra -Wl,--no-undefined)
TARGET_LINK_LIBRARIES(irxps PRIVATE)
SET_TARGET_PROPERTIES(irxps PROPERTIES VERSION ${IR_PROJECT_VERSION})
SET_TARGET_PROPERTIES(irxps PROPERTIES INSTALL_RPATH_USE_LINK_PATH TRUE)

INSTALL(TARGETS irxps EXPORT ${PROJECT_NAME}-targets LIBRARY DESTINATION ${IR_LIBDIR}/irxps ARCHIVE DESTINATION ${IR_LIBDIR}/irxps INCLUDES DESTINATION ${IR_INCDIR})
INSTALL(EXPORT ${PROJECT_NAME}-targets DESTINATION ${IR_CMAKEDIR})
INSTALL(DIRECTORY ${IR_PROJECT_DIR}/include/ DESTINATION ${IR_INCDIR})

add_library(irxps_gcov SHARED ${IR_XPS_SRC})
TARGET_INCLUDE_DIRECTORIES(irxps_gcov PUBLIC $<BUILD_INTERFACE:${IR_PROJECT_DIR}/include> PRIVATE .)
TARGET_LINK_LIBRARIES(irxps_gcov PRIVATE gcov)
TARGET_COMPILE_OPTIONS(irxps_gcov PRIVATE -fprofile-arcs -ftest-coverage)
